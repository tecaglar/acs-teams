// <copyright file="CardHelper.cs" company="PlaceholderCompany">
// Copyright (c) PlaceholderCompany. All rights reserved.
// </copyright>

namespace Calling.Helpers
{
    using AdaptiveCards;
    using Calling.Interfaces;
    using Calling.Models;
    using Microsoft.Bot.Schema;
    using Microsoft.Extensions.Logging;

    /// <summary>
    /// Helper for cards.
    /// </summary>
    public class CardHelper : ICard
    {
        private readonly ILogger<CardHelper> logger;

        /// <summary>
        /// Initializes a new instance of the <see cref="CardHelper"/> class.
        /// </summary>
        /// <param name="logger">ILogger instance.</param>
        public CardHelper(ILogger<CardHelper> logger)
        {
            this.logger = logger;
        }

        /// <inheritdoc/>
        public Attachment CreateNewQueryAttachment(CustomerInformation customer)
        {
            string card = "{\r\n    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\r\n    \"type\": \"AdaptiveCard\",\r\n    \"version\": \"1.2\",\r\n    \"body\": [\r\n        {\r\n            \"type\": \"Container\",\r\n            \"items\": [\r\n                {\r\n                    \"type\": \"TextBlock\",\r\n                    \"text\": \"New customer chat request\",\r\n                    \"weight\": \"Bolder\",\r\n                    \"size\": \"Medium\",\r\n                    \"height\": \"stretch\",\r\n                    \"spacing\": \"None\"\r\n                },\r\n                                {\r\n                    \"type\": \"ColumnSet\",\r\n                    \"columns\": [\r\n                        {\r\n                            \"type\": \"Column\",\r\n                            \"width\": \"auto\",\r\n                            \"items\": [\r\n                                {\r\n                                    \"size\": \"Small\",\r\n                                    \"style\": \"Person\",\r\n                                    \"type\": \"Image\",\r\n                                    \"url\": \"https://pbs.twimg.com/profile_images/3647943215/d7f12830b3c17a5a9e4afcc370e3a37e_400x400.jpeg\"\r\n                                }\r\n                            ],\r\n                            \"spacing\": \"None\"\r\n                        },\r\n                        {\r\n                            \"type\": \"Column\",\r\n                            \"width\": \"stretch\",\r\n                            \"items\": [\r\n                                {\r\n                                    \"type\": \"TextBlock\",\r\n                                    \"text\": \"" + customer.FirstName + " " + customer.LastName + "\",\r\n                                    \"weight\": \"Bolder\",\r\n                                    \"wrap\": true\r\n                                },\r\n                                {\r\n                                    \"type\": \"TextBlock\",\r\n                                    \"spacing\": \"None\",\r\n                                    \"text\": \"" + customer.MobileNumber + " | " + customer.EmailAddress + "\",\r\n                                    \"isSubtle\": true,\r\n                                    \"wrap\": true,\r\n                                    \"size\": \"Small\"\r\n                                }\r\n                            ]\r\n                        }\r\n                    ],\r\n                    \"spacing\": \"Large\"\r\n                }\r\n            ],\r\n            \"spacing\": \"None\"\r\n        },\r\n        {\r\n            \"type\": \"Container\",\r\n            \"style\": \"warning\",\r\n            \"items\": [\r\n                {\r\n                    \"type\": \"TextBlock\",\r\n                    \"text\": \" Query:\",\r\n                    \"wrap\": true,\r\n                    \"height\": \"stretch\",\r\n                    \"maxLines\": 10,\r\n                    \"fontType\": \"Default\",\r\n                    \"size\": \"Large\",\r\n                    \"weight\": \"Bolder\",\r\n                    \"color\": \"Dark\",\r\n                    \"spacing\": \"None\",\r\n                    \"isVisible\": true\r\n                },\r\n                {\r\n                    \"type\": \"TextBlock\",\r\n                    \"text\": \"" + customer.Query + "\",\r\n                    \"wrap\": true,\r\n                    \"height\": \"stretch\",\r\n                    \"fontType\": \"Default\",\r\n                    \"color\": \"Dark\",\r\n                    \"size\": \"Medium\"\r\n                }\r\n            ],\r\n            \"isVisible\": true,\r\n            \"verticalContentAlignment\": \"Center\",\r\n            \"spacing\": \"Large\",\r\n            \"backgroundImage\": {\r\n                \"url\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAsQAAAGZCAIAAAABz7BgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAetSURBVHhe7dzLUeNAAEVRmAjYExSxEhR7MtBoSi6DQeh3PRt0zsadgW+9bvtxGIYHAICj/lw+AQAOERMAQCImAIDk5s3E+9vrdHh6fpkOAADLPpaJa0mMPp8BABb8eM2hJwCALZbeTOgJAGDVygNMPQEALFv/NYeeAAAWrMfESE8AAD/ZFBMjPQEAzNoaEyM9AQB8tyMmAAC+2xcTxgkA4Ivdy4SeAAA+O3LNoScAgKuDbyb0BAAwOf4AU08AAKPjMTHSEwBAiomRngCAk6sxMdITAHBmd4iJkZ4AgNO6T0yM9AQAnNPdYmKkJwDghO4ZEyM9AQBnc+eYGOkJADiV+8fESE8AwHn8l5gAAM7jcRiG6WROAICzeXp+uZwCMQEApKpwzQEA/NsUDs8KYgIAuDiWFGICALixtyfEBADw1a6eEBMAwIztPSEmAIB5G3tCTAAAP9rSE2ICAFiy2hNiAgBIxAQAsGJ5nBATAEAiJgCAREwAAOsWbjrEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQfMTE0/PL5QQAcGuhEywTAEAiJgCA5CYm3HQAAN8tF4JlAgBIvsaEcQIA+Gy1DWaWCT0BAEy2VIFrDgBg3sZ9YT4mjBMAwEaPwzBcjnPe314vJwDgNHbNCivXHCYKADibvd/+K8vExD4BAGdwbETYFBMTSQEAv9jh64gdMXGlKgDgd7jLe4YjMQEAcOV/JgCAREwAAImYAAASMQEAJGICAAgeHv4C1n+RGfYdtucAAAAASUVORK5CYII=\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"Container\",\r\n            \"style\": \"accent\",\r\n            \"items\": [\r\n                {\r\n                    \"type\": \"TextBlock\",\r\n                    \"text\": \"Status:  " + customer.Status + "\",\r\n                    \"wrap\": true,\r\n                    \"color\": \"Dark\",\r\n                    \"size\": \"Medium\",\r\n                    \"fontType\": \"Default\",\r\n                    \"spacing\": \"Medium\",\r\n                    \"weight\": \"Bolder\"\r\n                }\r\n            ],\r\n            \"spacing\": \"Large\"\r\n        }\r\n    ],\r\n    \"actions\": [\r\n        {\r\n            \"type\": \"Action.Submit\",\r\n            \"title\": \"" + Constants.Accept + "\",\r\n            \"data\" : {\r\n              \"type\":\"" + Constants.Accept + "\"\r\n            }\r\n          },\r\n              {\r\n            \"type\": \"Action.Submit\",\r\n            \"title\": \"" + Constants.Reject + "\",\r\n            \"data\":{\r\n              \"type\":\"" + Constants.Reject + "\"\r\n            }\r\n          }\r\n    ]\r\n}";
            return this.ParseCardAttachmentFromJson(card);
        }

        /// <inheritdoc/>
        public Attachment HelpAttachment()
        {
            string card = "{\r\n    \"type\": \"AdaptiveCard\",\r\n    \"body\": [\r\n        {\r\n            \"type\": \"TextBlock\",\r\n            \"size\": \"Medium\",\r\n            \"weight\": \"Bolder\",\r\n            \"text\": \"Please choose one from below options\"\r\n        }\r\n    ],\r\n    \"actions\": [\r\n        {\r\n            \"type\": \"Action.Submit\",\r\n            \"title\": \"Request a call\",\r\n            \"id\": \"requestacall\",\r\n            \"data\": {\r\n                \"type\": \"requestacall\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"Action.Submit\",\r\n            \"title\": \"Place a call\",\r\n            \"id\": \"placeacall\",\r\n            \"data\": {\r\n                \"type\": \"placeacall\"\r\n            }\r\n        }\r\n    ],\r\n    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\r\n    \"version\": \"1.2\"\r\n}";
            return this.ParseCardAttachmentFromJson(card);
        }

        /// <inheritdoc/>
        public Attachment RaiseNewRequestAttachment()
        {
            string card = "{\r\n    \"type\": \"AdaptiveCard\",\r\n    \"body\": [\r\n        {\r\n            \"type\": \"TextBlock\",\r\n            \"size\": \"Medium\",\r\n            \"weight\": \"Bolder\",\r\n            \"text\": \"New chat request\"\r\n        },\r\n        {\r\n            \"type\": \"Input.Text\",\r\n            \"placeholder\": \"First name\",\r\n            \"id\": \"firstName\"\r\n        },\r\n        {\r\n            \"type\": \"Input.Text\",\r\n            \"placeholder\": \"Last name\",\r\n            \"id\": \"lastName\"\r\n        },\r\n        {\r\n            \"type\": \"Input.Text\",\r\n            \"placeholder\": \"Mobile number\",\r\n            \"id\": \"mobileNumber\"\r\n        },\r\n        {\r\n            \"type\": \"Input.Text\",\r\n            \"placeholder\": \"Email address\",\r\n            \"id\": \"emailAddress\"\r\n        },\r\n        {\r\n            \"type\": \"Input.Text\",\r\n            \"placeholder\": \"Enter your query here\",\r\n            \"id\": \"query\"\r\n        }\r\n    ],\r\n    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\r\n    \"version\": \"1.2\",\r\n    \"actions\": [\r\n        {\r\n            \"type\": \"Action.Submit\",\r\n            \"title\": \"Submit\",\r\n            \"id\": \"submitnewrequest\",\r\n            \"data\": {\r\n                \"type\": \"submitnewrequest\"\r\n            }\r\n        }\r\n    ]\r\n}";
            return this.ParseCardAttachmentFromJson(card);
        }

        /// <inheritdoc/>
        public Attachment TeamsChannelMeetingLinkAttachment(CustomerInformation customerInformation, string joinUrl)
        {
            string card = "{\r\n    \"type\": \"AdaptiveCard\",\r\n    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\r\n    \"version\": \"1.2\",\r\n    \"body\": [\r\n        {\r\n            \"type\": \"TextBlock\",\r\n            \"text\": \"[Click here to join meeting with " + customerInformation.FirstName + " " + customerInformation.LastName + " ](" + joinUrl + ")\",\r\n            \"wrap\": true\r\n        }\r\n    ]\r\n}";
            return this.ParseCardAttachmentFromJson(card);
        }

        /// <inheritdoc/>
        public Attachment WebChatMeetingLinkAttachment(string joinUrl)
        {
            string card = "{\r\n    \"type\": \"AdaptiveCard\",\r\n    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\r\n    \"version\": \"1.2\",\r\n    \"body\": [\r\n        {\r\n            \"type\": \"TextBlock\",\r\n            \"text\": \"[Click here to join meeting](" + joinUrl + ")\",\r\n            \"wrap\": true\r\n        }\r\n    ]\r\n}";
            return this.ParseCardAttachmentFromJson(card);
        }

        /// <inheritdoc/>
        public Attachment UpdateQueryStatusAttachment(CustomerInformation customer, string joinUrl)
        {
            string card = "{\r\n    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\r\n    \"type\": \"AdaptiveCard\",\r\n    \"version\": \"1.2\",\r\n    \"body\": [\r\n        {\r\n            \"type\": \"Container\",\r\n            \"items\": [\r\n                {\r\n                    \"type\": \"TextBlock\",\r\n                    \"text\": \"New customer chat request\",\r\n                    \"weight\": \"Bolder\",\r\n                    \"size\": \"Medium\",\r\n                    \"height\": \"stretch\",\r\n                    \"spacing\": \"None\"\r\n                },\r\n                                {\r\n                    \"type\": \"ColumnSet\",\r\n                    \"columns\": [\r\n                        {\r\n                            \"type\": \"Column\",\r\n                            \"width\": \"auto\",\r\n                            \"items\": [\r\n                                {\r\n                                    \"size\": \"Small\",\r\n                                    \"style\": \"Person\",\r\n                                    \"type\": \"Image\",\r\n                                    \"url\": \"https://pbs.twimg.com/profile_images/3647943215/d7f12830b3c17a5a9e4afcc370e3a37e_400x400.jpeg\"\r\n                                }\r\n                            ],\r\n                            \"spacing\": \"None\"\r\n                        },\r\n                        {\r\n                            \"type\": \"Column\",\r\n                            \"width\": \"stretch\",\r\n                            \"items\": [\r\n                                {\r\n                                    \"type\": \"TextBlock\",\r\n                                    \"text\": \"" + customer.FirstName + " " + customer.LastName + "\",\r\n                                    \"weight\": \"Bolder\",\r\n                                    \"wrap\": true\r\n                                },\r\n                                {\r\n                                    \"type\": \"TextBlock\",\r\n                                    \"spacing\": \"None\",\r\n                                    \"text\": \"" + customer.MobileNumber + " | " + customer.EmailAddress + "\",\r\n                                    \"isSubtle\": true,\r\n                                    \"wrap\": true,\r\n                                    \"size\": \"Small\"\r\n                                }\r\n                            ]\r\n                        }\r\n                    ],\r\n                    \"spacing\": \"Large\"\r\n                }\r\n            ],\r\n            \"spacing\": \"None\"\r\n        },\r\n        {\r\n            \"type\": \"Container\",\r\n            \"style\": \"warning\",\r\n            \"items\": [\r\n                {\r\n                    \"type\": \"TextBlock\",\r\n                    \"text\": \" Query:\",\r\n                    \"wrap\": true,\r\n                    \"height\": \"stretch\",\r\n                    \"maxLines\": 10,\r\n                    \"fontType\": \"Default\",\r\n                    \"size\": \"Large\",\r\n                    \"weight\": \"Bolder\",\r\n                    \"color\": \"Dark\",\r\n                    \"spacing\": \"None\",\r\n                    \"isVisible\": true\r\n                },\r\n                {\r\n                    \"type\": \"TextBlock\",\r\n                    \"text\": \"" + customer.Query + "\",\r\n                    \"wrap\": true,\r\n                    \"height\": \"stretch\",\r\n                    \"fontType\": \"Default\",\r\n                    \"color\": \"Dark\",\r\n                    \"size\": \"Medium\"\r\n                }\r\n            ],\r\n            \"isVisible\": true,\r\n            \"verticalContentAlignment\": \"Center\",\r\n            \"spacing\": \"Large\",\r\n            \"backgroundImage\": {\r\n                \"url\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAsQAAAGZCAIAAAABz7BgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAetSURBVHhe7dzLUeNAAEVRmAjYExSxEhR7MtBoSi6DQeh3PRt0zsadgW+9bvtxGIYHAICj/lw+AQAOERMAQCImAIDk5s3E+9vrdHh6fpkOAADLPpaJa0mMPp8BABb8eM2hJwCALZbeTOgJAGDVygNMPQEALFv/NYeeAAAWrMfESE8AAD/ZFBMjPQEAzNoaEyM9AQB8tyMmAAC+2xcTxgkA4Ivdy4SeAAA+O3LNoScAgKuDbyb0BAAwOf4AU08AAKPjMTHSEwBAiomRngCAk6sxMdITAHBmd4iJkZ4AgNO6T0yM9AQAnNPdYmKkJwDghO4ZEyM9AQBnc+eYGOkJADiV+8fESE8AwHn8l5gAAM7jcRiG6WROAICzeXp+uZwCMQEApKpwzQEA/NsUDs8KYgIAuDiWFGICALixtyfEBADw1a6eEBMAwIztPSEmAIB5G3tCTAAAP9rSE2ICAFiy2hNiAgBIxAQAsGJ5nBATAEAiJgCAREwAAOsWbjrEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQiAkAIBETAEAiJgCAREwAAImYAAASMQEAJGICAEjEBACQfMTE0/PL5QQAcGuhEywTAEAiJgCA5CYm3HQAAN8tF4JlAgBIvsaEcQIA+Gy1DWaWCT0BAEy2VIFrDgBg3sZ9YT4mjBMAwEaPwzBcjnPe314vJwDgNHbNCivXHCYKADibvd/+K8vExD4BAGdwbETYFBMTSQEAv9jh64gdMXGlKgDgd7jLe4YjMQEAcOV/JgCAREwAAImYAAASMQEAJGICAAgeHv4C1n+RGfYdtucAAAAASUVORK5CYII=\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"Container\",\r\n            \"style\": \"accent\",\r\n            \"items\": [\r\n                {\r\n                    \"type\": \"TextBlock\",\r\n                    \"text\": \"Status:  " + customer.Status + "\",\r\n                    \"wrap\": true,\r\n                    \"color\": \"Dark\",\r\n                    \"size\": \"Medium\",\r\n                    \"fontType\": \"Default\",\r\n                    \"spacing\": \"Medium\",\r\n                    \"weight\": \"Bolder\"\r\n                }\r\n            ],\r\n            \"spacing\": \"Large\"\r\n        }\r\n    ],\r\n    \"actions\": [\r\n        {\r\n            \"type\": \"Action.OpenUrl\",\r\n            \"title\": \"" + Constants.Join + "\",\r\n            \"url\":\"" + joinUrl + "\"\r\n          },\r\n              {\r\n            \"type\": \"Action.Submit\",\r\n            \"title\": \"" + Constants.Reassign + "\",\r\n            \"data\":{\r\n              \"type\":\"" + Constants.Reassign + "\"\r\n            }\r\n          }\r\n    ]\r\n}";
            return this.ParseCardAttachmentFromJson(card);
        }

        private Attachment ParseCardAttachmentFromJson(string card)
        {
            try
            {
                var parsedResult = AdaptiveCard.FromJson(card);
                var attachment = new Attachment
                {
                    ContentType = AdaptiveCard.ContentType,
                    Content = parsedResult.Card,
                };
                return attachment;
            }
            catch (AdaptiveSerializationException e)
            {
                this.logger.LogError(e.Message + " " + e.StackTrace);
                return null;
            }
        }
    }
}
